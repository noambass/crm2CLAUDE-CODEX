import React, { useState, useEffect } from 'react'; import { useNavigate } from 'react-router-dom'; import { createPageUrl } from '@/utils'; import { supabase } from '@/api/supabaseClient'; import { useAuth } from '@/lib/AuthContext'; import { Calendar as CalendarIcon, ChevronLeft, ChevronRight, Plus, Eye, Clock, MapPin } from 'lucide-react'; import { Button } from "@/components/ui/button"; import { Card, CardContent } from "@/components/ui/card"; import {   Dialog,   DialogContent,   DialogHeader,   DialogTitle,   DialogFooter, } from "@/components/ui/dialog"; import { Input } from "@/components/ui/input"; import { Label } from "@/components/ui/label"; import { JobStatusBadge } from "@/components/ui/DynamicStatusBadge"; import LoadingSpinner from "@/components/shared/LoadingSpinner"; import { startOfMonth, endOfMonth, eachDayOfInterval, format, addMonths, subMonths, isSameDay, startOfWeek, endOfWeek, isToday, isSameMonth } from 'date-fns'; import { he } from 'date-fns/locale'; import { toast } from 'sonner'; import { queryClientInstance } from '@/lib/query-client';  export default function Calendar() {   const navigate = useNavigate();   const { user, isLoadingAuth } = useAuth();   const [currentDate, setCurrentDate] = useState(new Date());    const [jobs, setJobs] = useState([]);    const [loading, setLoading] = useState(true);    const [selectedDay, setSelectedDay] = useState(null);    const [dayJobsModalOpen, setDayJobsModalOpen] = useState(false);    const [dayJobs, setDayJobs] = useState([]);    const [scheduleDialogOpen, setScheduleDialogOpen] = useState(false);    const [scheduleData, setScheduleData] = useState({ date: '', time: '' });    const [selectedJobForSchedule, setSelectedJobForSchedule] = useState(null);    const [selectedJobForQuickSchedule, setSelectedJobForQuickSchedule] = useState(null);    const [quickRescheduleOpen, setQuickRescheduleOpen] = useState(false);    const [quickRescheduleData, setQuickRescheduleData] = useState({ date: '', time: '' });    const [selectedJobForQuickReschedule, setSelectedJobForQuickReschedule] = useState(null);    const [viewDetails, setViewDetails] = useState('detailed'); /* minimal or detailed */    useEffect(() => {     if (!user) return;     loadJobs();   }, [currentDate, user]);    const loadJobs = async () => {     if (!user) return;     setLoading(true);     try {       const rangeStart = startOfWeek(startOfMonth(currentDate), { locale: he });       const rangeEnd = endOfWeek(endOfMonth(currentDate), { locale: he });        const scheduledQuery = supabase         .from('jobs')         .select('id, client_id, title, status, priority, scheduled_at, scheduled_date, scheduled_time, address, city, arrival_notes, created_at')         .eq('owner_id', user.id)         .gte('scheduled_at', rangeStart.toISOString())         .lte('scheduled_at', rangeEnd.toISOString())         .order('scheduled_at', { ascending: true, nullsFirst: false });        const unscheduledQuery = supabase         .from('jobs')         .select('id, client_id, title, status, priority, scheduled_at, scheduled_date, scheduled_time, address, city, arrival_notes, created_at')         .eq('owner_id', user.id)         .is('scheduled_at', null)         .order('created_at', { ascending: false });        const [scheduledRes, unscheduledRes] = await Promise.all([scheduledQuery, unscheduledQuery]);       if (scheduledRes.error) throw scheduledRes.error;       if (unscheduledRes.error) throw unscheduledRes.error;        const merged = [...(scheduledRes.data || []), ...(unscheduledRes.data || [])].map((job) => {         if (job.scheduled_at) {           const scheduledDate = new Date(job.scheduled_at);           return {             ...job,             scheduled_date: job.scheduled_date || format(scheduledDate, 'yyyy-MM-dd'),             scheduled_time: job.scheduled_time || format(scheduledDate, 'HH:mm')           };         }         return job;       });        setJobs(merged);     } catch (error) {       console.error('Error loading jobs:', error);       toast.error('שגיאה בטעינת עבודות', {         description: 'נסה שוב בעוד רגע',         duration: 4000       });     } finally {       setLoading(false);     }   };    const monthStart = startOfMonth(currentDate);   const monthEnd = endOfMonth(currentDate);   const calendarStart = startOfWeek(monthStart, { locale: he });   const calendarEnd = endOfWeek(monthEnd, { locale: he });   const calendarDays = eachDayOfInterval({ start: calendarStart, end: calendarEnd });    const getJobScheduledDate = (job) => {     if (job.scheduled_at) return new Date(job.scheduled_at);     if (job.scheduled_date) return new Date(job.scheduled_date);     return null;   };    const getJobsForDay = (day) => {     return jobs.filter((job) => {       const scheduledDate = getJobScheduledDate(job);       return scheduledDate && isSameDay(scheduledDate, day);     });   };    const getUnscheduledJobs = () => {     return jobs.filter(job => !getJobScheduledDate(job));   };    const handlePrevMonth = () => setCurrentDate(subMonths(currentDate, 1));   const handleNextMonth = () => setCurrentDate(addMonths(currentDate, 1));   const handleToday = () => setCurrentDate(new Date());    const handleDayClick = (day) => {     if (selectedJobForQuickSchedule) {       setScheduleData({ date: format(day, 'yyyy-MM-dd'), time: '' });       setScheduleDialogOpen(true);     } else {       setSelectedDay(day);       navigate(createPageUrl(`JobForm?date=${format(day, 'yyyy-MM-dd')}`));     }   };    const handleJobClick = (e, job) => {     e.stopPropagation();     navigate(createPageUrl(`JobDetails?id=${job.id}`));   };    const handleDayJobsModal = (day) => {     setSelectedDay(day);     const dayJobsList = getJobsForDay(day);     setDayJobs(dayJobsList);     setDayJobsModalOpen(true);   };    const handleScheduleJob = async () => {     const jobToSchedule = selectedJobForSchedule || selectedJobForQuickSchedule;     if (!jobToSchedule || !scheduleData.date || !scheduleData.time) return;     if (!user) return;      try {       const scheduledAt = new Date(`${scheduleData.date}T${scheduleData.time}`).toISOString();       const updateData = {         scheduled_at: scheduledAt,         scheduled_date: scheduleData.date,         scheduled_time: scheduleData.time       };        const { error } = await supabase         .from('jobs')         .update(updateData)         .eq('id', jobToSchedule.id)         .eq('owner_id', user.id);       if (error) throw error;        const updatedJobs = jobs.map(j => j.id === jobToSchedule.id ? {         ...j,         ...updateData       } : j);       setJobs(updatedJobs);        /* Update day jobs modal if open */       if (selectedDay) {         const updatedDayJobs = updatedJobs.filter((j) => {           const scheduledDate = getJobScheduledDate(j);           return scheduledDate && isSameDay(scheduledDate, selectedDay);         });         setDayJobs(updatedDayJobs);       }        setScheduleDialogOpen(false);       setScheduleData({ date: '', time: '' });       setSelectedJobForSchedule(null);       setSelectedJobForQuickSchedule(null);       toast.success('התזמון עודכן בהצלחה', {         duration: 3000       });       queryClientInstance.invalidateQueries({ queryKey: ['calendar'] });       queryClientInstance.invalidateQueries({ queryKey: ['jobs'] });     } catch (error) {       console.error('Error scheduling job:', error);       toast.error('שגיאה בעדכון התזמון', {         description: 'נסה שוב בעוד רגע',         duration: 4000       });     }   };    const handleQuickReschedule = async () => {     if (!selectedJobForQuickReschedule || !quickRescheduleData.date || !quickRescheduleData.time) return;     if (!user) return;      try {       const scheduledAt = new Date(`${quickRescheduleData.date}T${quickRescheduleData.time}`).toISOString();       const updateData = {         scheduled_at: scheduledAt,         scheduled_date: quickRescheduleData.date,         scheduled_time: quickRescheduleData.time       };        const { error } = await supabase         .from('jobs')         .update(updateData)         .eq('id', selectedJobForQuickReschedule.id)         .eq('owner_id', user.id);       if (error) throw error;        const updatedJobs = jobs.map(j => j.id === selectedJobForQuickReschedule.id ? {         ...j,         ...updateData       } : j);       setJobs(updatedJobs);        if (selectedDay) {         const updatedDayJobs = updatedJobs.filter((j) => {           const scheduledDate = getJobScheduledDate(j);           return scheduledDate && isSameDay(scheduledDate, selectedDay);         });         setDayJobs(updatedDayJobs);       }        setQuickRescheduleOpen(false);       setQuickRescheduleData({ date: '', time: '' });       setSelectedJobForQuickReschedule(null);       toast.success('התזמון עודכן בהצלחה', {         duration: 3000       });       queryClientInstance.invalidateQueries({ queryKey: ['calendar'] });       queryClientInstance.invalidateQueries({ queryKey: ['jobs'] });     } catch (error) {       console.error('Error rescheduling job:', error);       toast.error('שגיאה בעדכון התזמון', {         description: 'נסה שוב בעוד רגע',         duration: 4000       });     }   };    const weekDays = ['א', 'ב', 'ג', 'ד', 'ה', 'ו', 'ש'];    if (isLoadingAuth) return <LoadingSpinner />;   if (!user) return null;   if (loading) return <LoadingSpinner />;    const now = new Date();    return (     <div dir="rtl" className="p-4 lg:p-8 space-y-6">       {/* Header */}       <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">         <div className="flex items-center gap-3">           <div className="w-12 h-12 rounded-xl bg-emerald-100 flex items-center justify-center">             <CalendarIcon className="w-6 h-6 text-emerald-600" />           </div>           <div>             <h1 className="text-2xl font-bold text-slate-800">לוח שנה</h1>             <p className="text-slate-500">נהל את העבודות והתזמונים שלך</p>           </div>         </div>         <Button           onClick={() => navigate(createPageUrl('JobForm'))}           className="bg-[#00214d] hover:bg-[#00214d]/90"         >           <Plus className="w-4 h-4 ml-2" />           עבודה חדשה         </Button>       </div>        {/* Unscheduled Jobs Section */}        {getUnscheduledJobs().length > 0 && (          <Card className="border-0 shadow-sm border-l-4 border-l-amber-500 bg-amber-50">            <CardContent className="p-4">              <h3 className="font-semibold text-amber-900 mb-3">עבודות לתזמון ({getUnscheduledJobs().length})</h3>              <div className="space-y-2 max-h-48 overflow-y-auto">                {getUnscheduledJobs().slice(0, 10).map((job) => (                  <Card                     key={job.id}                     className={`border-0 shadow-sm hover:shadow-md transition-all cursor-pointer ${                      selectedJobForQuickSchedule?.id === job.id ? 'ring-2 ring-amber-500 bg-amber-100' : ''                    }`}                  >                    <CardContent className="p-3">                      <div className="flex items-start justify-between gap-3">                        <div                           className="flex-1 min-w-0"                          onClick={() => setSelectedJobForQuickSchedule(job)}                        >                          <h4 className="font-semibold text-slate-800 text-sm mb-1">{job.title}</h4>                          <p className="text-xs text-slate-600 mb-1">{job.client_name}</p>                          {job.description && (                            <p className="text-xs text-slate-500 line-clamp-1 mb-1">{job.description}</p>                          )}                          {(job.address || job.city) && (                            <div className="flex items-center gap-1 text-xs text-slate-500">                              <MapPin className="w-3 h-3" />                              <span className="line-clamp-1">{job.address}{job.city ? `, ${job.city}` : ''}</span>                            </div>                          )}                          {selectedJobForQuickSchedule?.id === job.id && (                            <p className="text-xs text-amber-700 mt-1 font-medium">בחר יום בלוח שנה</p>                          )}                        </div>                      </div>                    </CardContent>                  </Card>                ))}                {getUnscheduledJobs().length > 10 && (                  <p className="text-xs text-amber-700 text-center py-2">ועוד {getUnscheduledJobs().length - 10} עבודות לתזמון</p>                )}              </div>            </CardContent>          </Card>        )}        {/* Calendar Navigation */}        <Card className="border-0 shadow-sm">          <CardContent className="p-6">           <div className="flex items-center justify-between mb-6">             <div className="flex items-center gap-2">               <Button variant="outline" size="icon" onClick={handlePrevMonth}>                 <ChevronRight className="w-4 h-4" />               </Button>               <Button variant="outline" size="icon" onClick={handleNextMonth}>                 <ChevronLeft className="w-4 h-4" />               </Button>             </div>             <h2 className="text-xl font-bold text-slate-800">               {format(currentDate, 'MMMM yyyy', { locale: he })}             </h2>             <Button variant="outline" onClick={handleToday}>               היום             </Button>           </div>            <div className="flex items-center gap-2 mb-4">             <span className="text-sm text-slate-600">תצוגה:</span>             <Button               variant={viewDetails === 'minimal' ? 'default' : 'outline'}               size="sm"               onClick={() => setViewDetails('minimal')}               style={viewDetails === 'minimal' ? { backgroundColor: '#00214d' } : {}}             >               <Eye className="w-4 h-4 ml-1" />               מינימלי             </Button>             <Button               variant={viewDetails === 'detailed' ? 'default' : 'outline'}               size="sm"               onClick={() => setViewDetails('detailed')}               style={viewDetails === 'detailed' ? { backgroundColor: '#00214d' } : {}}             >               <Eye className="w-4 h-4 ml-1" />               מפורט             </Button>           </div>            {/* Calendar Grid */}           <div className="grid grid-cols-7 gap-2">             {/* Week days header */}             {weekDays.map((day) => (               <div key={day} className="text-center font-semibold text-slate-600 py-2">                 {day}               </div>             ))}              {/* Calendar days */}             {calendarDays.map((day, idx) => {               const dayJobs = getJobsForDay(day);               const isCurrentMonth = isSameMonth(day, currentDate);               const isDayToday = isToday(day);                return (                 <div                   key={idx}                   onClick={() => handleDayClick(day)}                   className={`                     min-h-24 p-2 rounded-lg border cursor-pointer transition-all                     ${isDayToday ? 'border-emerald-500 bg-emerald-50' : 'border-slate-200 hover:border-emerald-300 hover:bg-emerald-50/50'}                     ${!isCurrentMonth ? 'opacity-40' : ''}                   `}                 >                   <div className={`text-sm font-medium mb-1 ${isDayToday ? 'text-emerald-600' : 'text-slate-600'}`}>                     {format(day, 'd')}                   </div>                   <div className="space-y-1">                     {dayJobs.slice(0, viewDetails === 'minimal' ? 1 : 2).map((job) => (                        <div                          key={job.id}                          onClick={(e) => handleJobClick(e, job)}                          className="text-xs p-1.5 bg-white rounded border border-slate-200 hover:border-emerald-300 hover:shadow-sm transition-all cursor-pointer group"                        >                          <div className="font-medium text-slate-700 truncate group-hover:text-emerald-700">{job.title}</div>                          {viewDetails === 'detailed' && (                            <>                              {job.scheduled_time && (                                <div className="text-slate-500 text-xs mt-0.5 flex items-center gap-1">                                  <Clock className="w-2.5 h-2.5" />                                  {job.scheduled_time}                                </div>                              )}                              {job.address && (                                <div className="text-slate-500 text-xs truncate flex items-center gap-1">                                  <MapPin className="w-2.5 h-2.5" />                                  {job.address}{job.city ? `, ${job.city}` : ''}                                </div>                              )}                            </>                          )}                          <div className="flex items-center gap-1 mt-1">                            <JobStatusBadge status={job.status} />                          </div>                        </div>                      ))}                     {dayJobs.length > (viewDetails === 'minimal' ? 1 : 2) && (                       <button                          type="button"                         onClick={(e) => {                           e.stopPropagation();                           handleDayJobsModal(day);                         }}                         className="text-xs text-emerald-600 hover:text-emerald-700 font-medium py-1 w-full hover:bg-emerald-50 rounded transition-colors"                       >                         +{dayJobs.length - (viewDetails === 'minimal' ? 1 : 2)} נוספות                       </button>                     )}                   </div>                 </div>               );             })}           </div>         </CardContent>         </Card>          {/* Day Jobs Modal */}         <Dialog open={dayJobsModalOpen} onOpenChange={setDayJobsModalOpen}>          <DialogContent className="max-w-2xl max-h-96 overflow-y-auto">            <DialogHeader>              <DialogTitle>                עבודות ליום {selectedDay ? format(selectedDay, 'dd/MM/yyyy') : ''}              </DialogTitle>            </DialogHeader>             <div className="space-y-3">              {dayJobs.map((job) => (                <Card key={job.id} className="border-0 shadow-sm hover:shadow-md transition-all cursor-pointer">                  <CardContent className="p-3">                    <div className="flex items-start justify-between gap-4">                      <div                         className="flex-1 min-w-0"                        onClick={() => navigate(createPageUrl(`JobDetails?id=${job.id}`))}                      >                        <h4 className="font-semibold text-slate-800">{job.title}</h4>                        <p className="text-sm text-slate-600">{job.client_name}</p>                        {job.line_items && job.line_items.length > 0 && (                          <p className="text-xs text-slate-500 mt-1">                            {job.line_items.map(item => item.description).join(', ')}                          </p>                        )}                        <div className="space-y-1 mt-2 text-sm text-slate-600">                          {job.address && (                            <div className="flex items-center gap-2">                              <MapPin className="w-4 h-4" />                              {job.address}{job.city ? `, ${job.city}` : ''}                            </div>                          )}                          {job.scheduled_time && (                            <div className="flex items-center gap-2">                              <Clock className="w-4 h-4" />                              {job.scheduled_time}                            </div>                          )}                        </div>                        <div className="mt-2">                          <JobStatusBadge status={job.status} />                        </div>                      </div>                      <div className="flex flex-col gap-2">                        {!getJobScheduledDate(job) && (                          <Button                            size="sm"                            onClick={(e) => {                              e.stopPropagation();                              setSelectedJobForSchedule(job);                              setScheduleData({ date: format(selectedDay, 'yyyy-MM-dd'), time: '' });                              setScheduleDialogOpen(true);                            }}                            className="bg-emerald-500 hover:bg-emerald-600 text-white whitespace-nowrap"                          >                            <Clock className="w-3 h-3 ml-1" />                            תזמן                          </Button>                        )}                        {getJobScheduledDate(job) && (                          <Button                            size="sm"                            variant="outline"                            onClick={(e) => {                              e.stopPropagation();                              const scheduledDate = getJobScheduledDate(job);                              setSelectedJobForQuickReschedule(job);                              setQuickRescheduleData({                                date: scheduledDate ? format(scheduledDate, 'yyyy-MM-dd') : '',                                time: job.scheduled_time || (scheduledDate ? format(scheduledDate, 'HH:mm') : '')                              });                              setQuickRescheduleOpen(true);                            }}                            className="whitespace-nowrap"                          >                            שינוי תאריך/שעה                          </Button>                        )}                      </div>                    </div>                  </CardContent>                </Card>              ))}            </div>          </DialogContent>         </Dialog>          {/* Schedule Dialog */}         <Dialog open={scheduleDialogOpen} onOpenChange={setScheduleDialogOpen}>          <DialogContent className="max-w-md">            <DialogHeader>              <DialogTitle>תזמון עבודה: {(selectedJobForSchedule || selectedJobForQuickSchedule)?.title}</DialogTitle>            </DialogHeader>             <div className="space-y-4">              <div className="space-y-2">                <Label htmlFor="schedule-date">תאריך</Label>                <Input                  id="schedule-date"                  type="date"                  value={scheduleData.date}                  onChange={(e) => setScheduleData(prev => ({ ...prev, date: e.target.value }))}                />              </div>               <div className="space-y-2">                <Label htmlFor="schedule-time">שעה</Label>                <select                  id="schedule-time"                  value={scheduleData.time}                  onChange={(e) => setScheduleData(prev => ({ ...prev, time: e.target.value }))}                  className="w-full px-3 py-2 rounded-md border border-slate-200 bg-white text-sm"                >                  <option value="">בחר שעה...</option>                  {(() => {                    const times = [];                    for (let h = 0; h < 24; h++) {                      for (let m = 0; m < 60; m += 30) {                        const hour = String(h).padStart(2, '0');                        const minute = String(m).padStart(2, '0');                        times.push(`${hour}:${minute}`);                      }                    }                    return times.map(time => (                      <option key={time} value={time}>{time}</option>                    ));                  })()}                </select>              </div>            </div>             <DialogFooter className="flex-row-reverse gap-2">              <Button                onClick={handleScheduleJob}                disabled={!scheduleData.date || !scheduleData.time}                style={{ backgroundColor: '#00214d' }}                className="hover:opacity-90"              >                תזמן              </Button>              <Button                type="button"                variant="outline"                onClick={() => {                  setScheduleDialogOpen(false);                  setScheduleData({ date: '', time: '' });                  setSelectedJobForSchedule(null);                }}              >                ביטול              </Button>            </DialogFooter>          </DialogContent>         </Dialog>          {/* Quick Reschedule Dialog */}         <Dialog open={quickRescheduleOpen} onOpenChange={setQuickRescheduleOpen}>           <DialogContent className="max-w-md">             <DialogHeader>               <DialogTitle>שינוי תאריך ושעה</DialogTitle>             </DialogHeader>              <div className="space-y-4">               <div className="space-y-2">                 <Label htmlFor="quick-reschedule-date">תאריך</Label>                 <Input                   id="quick-reschedule-date"                   type="date"                   value={quickRescheduleData.date}                   onChange={(e) => setQuickRescheduleData(prev => ({ ...prev, date: e.target.value }))}                 />               </div>                <div className="space-y-2">                 <Label htmlFor="quick-reschedule-time">שעה</Label>                 <select                   id="quick-reschedule-time"                   value={quickRescheduleData.time}                   onChange={(e) => setQuickRescheduleData(prev => ({ ...prev, time: e.target.value }))}                   className="w-full px-3 py-2 rounded-md border border-slate-200 bg-white text-sm"                 >                   <option value="">בחר שעה...</option>                   {(() => {                     const times = [];                     for (let h = 0; h < 24; h++) {                       for (let m = 0; m < 60; m += 30) {                         const hour = String(h).padStart(2, '0');                         const minute = String(m).padStart(2, '0');                         times.push(`${hour}:${minute}`);                       }                     }                     return times.map(time => (                       <option key={time} value={time}>{time}</option>                     ));                   })()}                 </select>               </div>             </div>              <DialogFooter className="flex-row-reverse gap-2">               <Button                 onClick={handleQuickReschedule}                 disabled={!quickRescheduleData.date || !quickRescheduleData.time}                 style={{ backgroundColor: '#00214d' }}                 className="hover:opacity-90"               >                 שמור               </Button>               <Button                 type="button"                 variant="outline"                 onClick={() => {                   setQuickRescheduleOpen(false);                   setQuickRescheduleData({ date: '', time: '' });                   setSelectedJobForQuickReschedule(null);                 }}               >                 ביטול               </Button>             </DialogFooter>           </DialogContent>         </Dialog>          {/* Stats */}       <div className="grid grid-cols-2 lg:grid-cols-4 gap-4">         <Card className="border-0 shadow-sm">           <CardContent className="p-4">             <p className="text-sm text-slate-500 mb-1">עבודות החודש</p>             <p className="text-2xl font-bold text-slate-800">               {jobs.filter((job) => {                 const scheduledDate = getJobScheduledDate(job);                 return scheduledDate && isSameMonth(scheduledDate, currentDate);               }).length}             </p>           </CardContent>         </Card>         <Card className="border-0 shadow-sm">           <CardContent className="p-4">             <p className="text-sm text-slate-500 mb-1">מתוזמנות</p>             <p className="text-2xl font-bold text-blue-600">               {jobs.filter((job) => {                 const scheduledDate = getJobScheduledDate(job);                 return scheduledDate && job.status === 'waiting_execution' && scheduledDate > now && isSameMonth(scheduledDate, currentDate);               }).length}             </p>           </CardContent>         </Card>         <Card className="border-0 shadow-sm">           <CardContent className="p-4">             <p className="text-sm text-slate-500 mb-1">בביצוע</p>             <p className="text-2xl font-bold text-orange-600">               {jobs.filter((job) => {                 const scheduledDate = getJobScheduledDate(job);                 return scheduledDate && job.status === 'waiting_execution' && scheduledDate <= now && isSameMonth(scheduledDate, currentDate);               }).length}             </p>           </CardContent>         </Card>         <Card className="border-0 shadow-sm">           <CardContent className="p-4">             <p className="text-sm text-slate-500 mb-1">הושלמו</p>             <p className="text-2xl font-bold text-green-600">               {jobs.filter((job) => {                 const scheduledDate = getJobScheduledDate(job);                 return scheduledDate && job.status === 'done' && isSameMonth(scheduledDate, currentDate);               }).length}             </p>           </CardContent>         </Card>       </div>     </div>   ); }  

